<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>VP Calculator by sekireiberry08</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
      margin: 0;
      padding: 40px;
      background: linear-gradient(to bottom right, #f9f9f9, #e8f0ff);
      color: #333;
      display: flex;
      gap: 40px;
    }

    body {
      background-image: url("zyipc46j76r41.gif");
      background-size: cover;
      background-repeat: no-repeat;
      background-position: center;
      position: relative;
    }

    body::before {
      content: "";
      position: fixed;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(255,255,255,0.5);
      z-index: -1;
    }

    .main {
      flex: 2;
    }

    .instructions {
      flex: 1;
      background: #fff;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      font-size: 14px;
      height: fit-content;
    }

    h2 {
      margin-bottom: 30px;
      color: #222;
    }

    label {
      display: block;
      margin: 10px 0 5px;
      font-weight: 600;
    }

    input[type="number"] {
      width: 200px;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 16px;
      margin-bottom: 15px;
      transition: border-color 0.3s;
    }

    input[type="number"]:focus {
      border-color: #5b9bff;
      outline: none;
    }

    button {
      padding: 10px 20px;
      font-size: 16px;
      font-weight: 600;
      background-color: #4a90e2;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      margin-top: 10px;
      transition: background-color 0.3s;
    }

    button:hover {
      background-color: #3c78c9;
    }

    .result {
      margin-top: 30px;
      padding: 20px;
      border-radius: 8px;
      background-color: #fff;
      box-shadow: 0 0 10px rgba(0,0,0,0.05);
      white-space: pre-line;
    }

    .error {
      color: red;
      font-weight: bold;
      margin-top: 15px;
      animation: shake 0.3s;
    }

    ul {
      margin-top: 10px;
      padding-left: 20px;
    }

    li {
      margin-bottom: 5px;
    }

    @keyframes shake {
      0% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      50% { transform: translateX(5px); }
      75% { transform: translateX(-3px); }
      100% { transform: translateX(0); }
    }
  </style>
</head>
<body>

  <div class="main">
    <h2>Công cụ tính toán số tiền nạp VP Valorant</h2>

    <label for="vpNeeded">Số VP bạn muốn sở hữu:</label>
    <input type="number" id="vpNeeded" min="1" placeholder="" />

    <label for="vpCurrent">Số VP bạn đang có:</label>
    <input type="number" id="vpCurrent" min="0" value="0" placeholder="" />

    <button onclick="tinhTien()">Tính toán</button>

    <div id="error" class="error"></div>
    <div class="result" id="result"></div>
  </div>

  <div class="instructions">
    <h3>Hướng dẫn sử dụng</h3>
    <ul>
      <li>Phím <strong>Enter</strong>: Thực hiện tính toán</li>
      <li>Phím <strong>Tab</strong>: Chuyển sang ô nhập tiếp theo</li>
    </ul>
  </div>

  <script>
    const packages = [
      { vp: 52, cost: 10000 },
      { vp: 110, cost: 20000 },
      { vp: 275, cost: 50000 },
      { vp: 610, cost: 100000 },
      { vp: 1220, cost: 200000 },
      { vp: 3040, cost: 500000 },
      { vp: 6550, cost: 1000000 },
      { vp: 13250, cost: 2000000 }
    ];

    function tinhTien() {
      const currentVP = parseInt(document.getElementById("vpCurrent").value) || 0;
      const neededVP = parseInt(document.getElementById("vpNeeded").value);
      const resultDiv = document.getElementById("result");
      const errorDiv = document.getElementById("error");

      resultDiv.innerHTML = "";
      errorDiv.innerHTML = "";

      if (isNaN(neededVP) || neededVP <= 0) {
        errorDiv.innerHTML = "Vui lòng nhập số VP bạn muốn sở hữu.";
        return;
      }

      let remainingVP = neededVP - currentVP;

      if (remainingVP <= 0) {
        resultDiv.innerHTML = "Bạn đã đủ VP, không cần nạp thêm.";
        return;
      }

      // DP
      const maxVP = remainingVP + Math.max(...packages.map(p => p.vp));
      const dp = Array(maxVP + 1).fill(null);
      dp[0] = { cost: 0, prev: null, pkg: null, vp: 0 };

      for (let v = 0; v <= maxVP; v++) {
        if (!dp[v]) continue;
        for (let pkg of packages) {
          let nv = v + pkg.vp;
          if (nv > maxVP) continue;
          let newCost = dp[v].cost + pkg.cost;
          if (
            !dp[nv] ||
            newCost < dp[nv].cost ||
            (newCost === dp[nv].cost && nv > dp[nv].vp)
          ) {
            dp[nv] = { cost: newCost, prev: v, pkg, vp: nv };
          }
        }
      }

      let best = null;
      for (let v = remainingVP; v <= maxVP; v++) {
        if (!dp[v]) continue;
        if (
          !best ||
          dp[v].cost < best.cost ||
          (dp[v].cost === best.cost && v > best.vp)
        ) {
          best = dp[v];
        }
      }

      if (!best) {
        resultDiv.innerHTML = "Không tìm được cách nạp phù hợp.";
        return;
      }

      // Truy ngược
      let dpCount = {};
      let cur = best;
      while (cur && cur.prev !== null) {
        let key = `${cur.pkg.vp}_${cur.pkg.cost}`;
        if (!dpCount[key]) dpCount[key] = { ...cur.pkg, count: 0 };
        dpCount[key].count++;
        cur = dp[cur.prev];
      }

      // Kết quả
      let output = 
        `Số VP cần nạp thêm: ${remainingVP} VP\n` +
        `Tổng tiền phải nạp: ${best.cost.toLocaleString()} VND\n` +
        `Số VP thực nhận: ${best.vp} VP (dư ${best.vp - remainingVP} VP)\n\n` +
        `Các gói đã chọn:\n`;

      for (let key in dpCount) {
        let entry = dpCount[key];
        output += `• ${entry.count} gói ${entry.vp} VP – ${entry.cost.toLocaleString()} VND\n`;
      }

      resultDiv.innerHTML = output;
      resultDiv.scrollIntoView({ behavior: "smooth" });
    }

    // Enter ở bất kỳ đâu => tính toán
    document.addEventListener("keydown", function (e) {
      if (e.key === "Enter") {
        e.preventDefault();
        tinhTien();
      }
    });
  </script>
</body>
</html>
